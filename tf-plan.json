{"format_version":"1.0","terraform_version":"1.1.6","variables":{"region":{"value":"eu-west-1"}},"planned_values":{"root_module":{"resources":[{"address":"aws_iam_account_password_policy.strict","mode":"managed","type":"aws_iam_account_password_policy","name":"strict","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allow_users_to_change_password":true,"max_password_age":3,"minimum_password_length":8},"sensitive_values":{}}],"child_modules":[{"resources":[{"address":"module.cloudtrail.aws_cloudtrail.insecure-logging","mode":"managed","type":"aws_cloudtrail","name":"insecure-logging","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":false,"event_selector":[],"include_global_service_events":true,"is_multi_region_trail":false,"is_organization_trail":false,"kms_key_id":null,"name":"cloudtrail-logging","s3_bucket_name":"my-cloudtrail-bucket","s3_key_prefix":null,"sns_topic_name":null,"tags":null},"sensitive_values":{"event_selector":[]}}],"address":"module.cloudtrail"},{"resources":[{"address":"module.pki.aws_kms_key.a","mode":"managed","type":"aws_kms_key","name":"a","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":10,"description":"key 1","enable_key_rotation":false,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","tags":null},"sensitive_values":{}}],"address":"module.pki"},{"resources":[{"address":"module.storage.aws_ebs_volume.example","mode":"managed","type":"aws_ebs_volume","name":"example","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"availability_zone":"us-east-1a","encrypted":false,"multi_attach_enabled":null,"outpost_arn":null,"size":20,"tags":{"Name":"insecure"}},"sensitive_values":{"tags":{}}},{"address":"module.storage.aws_s3_bucket.insecure-bucket","mode":"managed","type":"aws_s3_bucket","name":"insecure-bucket","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","bucket":"insecure-bucket","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[],"tags":null,"website":[]},"sensitive_values":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"versioning":[],"website":[]}}],"address":"module.storage"},{"resources":[{"address":"module.vpc.aws_default_security_group.default","mode":"managed","type":"aws_default_security_group","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"egress":[],"ingress":[{"cidr_blocks":[],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":true,"to_port":0}],"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"sensitive_values":{"egress":[],"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}]}},{"address":"module.vpc.aws_security_group.allow_ssh","mode":"managed","type":"aws_security_group","name":"allow_ssh","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Allow SSH inbound from anywhere","ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22}],"name":"allow_ssh","name_prefix":null,"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"sensitive_values":{"egress":[],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}]}},{"address":"module.vpc.aws_security_group.allow_ssh_with_valid_cidr","mode":"managed","type":"aws_security_group","name":"allow_ssh_with_valid_cidr","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Allow SSH inbound from specific range","ingress":[{"cidr_blocks":["255.255.255.0/24"],"description":"","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22}],"name":"allow_ssh_with_valid_cidr","name_prefix":null,"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"sensitive_values":{"egress":[],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}]}},{"address":"module.vpc.aws_vpc.example","mode":"managed","type":"aws_vpc","name":"example","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_generated_ipv6_cidr_block":false,"cidr_block":"255.255.255.0/24","enable_dns_support":true,"instance_tenancy":"default","tags":null},"sensitive_values":{}}],"address":"module.vpc"}]}},"resource_changes":[{"address":"aws_iam_account_password_policy.strict","mode":"managed","type":"aws_iam_account_password_policy","name":"strict","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allow_users_to_change_password":true,"max_password_age":3,"minimum_password_length":8},"after_unknown":{"expire_passwords":true,"hard_expiry":true,"id":true,"password_reuse_prevention":true,"require_lowercase_characters":true,"require_numbers":true,"require_symbols":true,"require_uppercase_characters":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.cloudtrail.aws_cloudtrail.insecure-logging","module_address":"module.cloudtrail","mode":"managed","type":"aws_cloudtrail","name":"insecure-logging","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":false,"event_selector":[],"include_global_service_events":true,"is_multi_region_trail":false,"is_organization_trail":false,"kms_key_id":null,"name":"cloudtrail-logging","s3_bucket_name":"my-cloudtrail-bucket","s3_key_prefix":null,"sns_topic_name":null,"tags":null},"after_unknown":{"arn":true,"event_selector":[],"home_region":true,"id":true},"before_sensitive":false,"after_sensitive":{"event_selector":[]}}},{"address":"module.pki.aws_kms_key.a","module_address":"module.pki","mode":"managed","type":"aws_kms_key","name":"a","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":10,"description":"key 1","enable_key_rotation":false,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","tags":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"policy":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.storage.aws_ebs_volume.example","module_address":"module.storage","mode":"managed","type":"aws_ebs_volume","name":"example","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"availability_zone":"us-east-1a","encrypted":false,"multi_attach_enabled":null,"outpost_arn":null,"size":20,"tags":{"Name":"insecure"}},"after_unknown":{"arn":true,"id":true,"iops":true,"kms_key_id":true,"snapshot_id":true,"tags":{},"type":true},"before_sensitive":false,"after_sensitive":{"tags":{}}}},{"address":"module.storage.aws_s3_bucket.insecure-bucket","module_address":"module.storage","mode":"managed","type":"aws_s3_bucket","name":"insecure-bucket","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","bucket":"insecure-bucket","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[],"tags":null,"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[],"versioning":true,"website":[],"website_domain":true,"website_endpoint":true},"before_sensitive":false,"after_sensitive":{"cors_rule":[],"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"replication_configuration":[],"server_side_encryption_configuration":[],"versioning":[],"website":[]}}},{"address":"module.vpc.aws_default_security_group.default","module_address":"module.vpc","mode":"managed","type":"aws_default_security_group","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"egress":[],"ingress":[{"cidr_blocks":[],"description":"","from_port":0,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"-1","security_groups":[],"self":true,"to_port":0}],"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"description":true,"egress":[],"id":true,"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"name":true,"owner_id":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[],"ingress":[{"cidr_blocks":[],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}]}}},{"address":"module.vpc.aws_security_group.allow_ssh","module_address":"module.vpc","mode":"managed","type":"aws_security_group","name":"allow_ssh","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Allow SSH inbound from anywhere","ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":"","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22}],"name":"allow_ssh","name_prefix":null,"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"owner_id":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}]}}},{"address":"module.vpc.aws_security_group.allow_ssh_with_valid_cidr","module_address":"module.vpc","mode":"managed","type":"aws_security_group","name":"allow_ssh_with_valid_cidr","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Allow SSH inbound from specific range","ingress":[{"cidr_blocks":["255.255.255.0/24"],"description":"","from_port":22,"ipv6_cidr_blocks":[],"prefix_list_ids":[],"protocol":"tcp","security_groups":[],"self":false,"to_port":22}],"name":"allow_ssh_with_valid_cidr","name_prefix":null,"revoke_rules_on_delete":false,"tags":null,"timeouts":null},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}],"owner_id":true,"vpc_id":true},"before_sensitive":false,"after_sensitive":{"egress":[],"ingress":[{"cidr_blocks":[false],"ipv6_cidr_blocks":[],"prefix_list_ids":[],"security_groups":[]}]}}},{"address":"module.vpc.aws_vpc.example","module_address":"module.vpc","mode":"managed","type":"aws_vpc","name":"example","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_generated_ipv6_cidr_block":false,"cidr_block":"255.255.255.0/24","enable_dns_support":true,"instance_tenancy":"default","tags":null},"after_unknown":{"arn":true,"default_network_acl_id":true,"default_route_table_id":true,"default_security_group_id":true,"dhcp_options_id":true,"enable_classiclink":true,"enable_classiclink_dns_support":true,"enable_dns_hostnames":true,"id":true,"ipv6_association_id":true,"ipv6_cidr_block":true,"main_route_table_id":true,"owner_id":true},"before_sensitive":false,"after_sensitive":{}}}],"configuration":{"provider_config":{"aws":{"name":"aws","version_constraint":"~\u003e 2.67","expressions":{"access_key":{"constant_value":"mock_access_key"},"region":{"references":["var.region"]},"secret_key":{"constant_value":"mock_secret_key"},"skip_credentials_validation":{"constant_value":true},"skip_metadata_api_check":{"constant_value":true},"skip_requesting_account_id":{"constant_value":true}}}},"root_module":{"resources":[{"address":"aws_iam_account_password_policy.strict","mode":"managed","type":"aws_iam_account_password_policy","name":"strict","provider_config_key":"aws","expressions":{"max_password_age":{"constant_value":3},"minimum_password_length":{"constant_value":8}},"schema_version":0}],"module_calls":{"cloudtrail":{"source":"./modules/cloudtrail","module":{"resources":[{"address":"aws_cloudtrail.insecure-logging","mode":"managed","type":"aws_cloudtrail","name":"insecure-logging","provider_config_key":"cloudtrail:aws","expressions":{"enable_logging":{"constant_value":false},"name":{"constant_value":"cloudtrail-logging"},"s3_bucket_name":{"constant_value":"my-cloudtrail-bucket"}},"schema_version":0}]}},"pki":{"source":"./modules/pki","module":{"resources":[{"address":"aws_kms_key.a","mode":"managed","type":"aws_kms_key","name":"a","provider_config_key":"pki:aws","expressions":{"deletion_window_in_days":{"constant_value":10},"description":{"constant_value":"key 1"}},"schema_version":0}]}},"storage":{"source":"./modules/storage","module":{"resources":[{"address":"aws_ebs_volume.example","mode":"managed","type":"aws_ebs_volume","name":"example","provider_config_key":"storage:aws","expressions":{"availability_zone":{"constant_value":"us-east-1a"},"encrypted":{"constant_value":false},"size":{"constant_value":20},"tags":{"constant_value":{"Name":"insecure"}}},"schema_version":0},{"address":"aws_s3_bucket.insecure-bucket","mode":"managed","type":"aws_s3_bucket","name":"insecure-bucket","provider_config_key":"storage:aws","expressions":{"bucket":{"constant_value":"insecure-bucket"}},"schema_version":0}]}},"vpc":{"source":"./modules/vpc","module":{"outputs":{"vpc_id":{"expression":{"references":["aws_vpc.example.id","aws_vpc.example"]}}},"resources":[{"address":"aws_default_security_group.default","mode":"managed","type":"aws_default_security_group","name":"default","provider_config_key":"vpc:aws","expressions":{"ingress":{"constant_value":[{"cidr_blocks":null,"description":null,"from_port":0,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"-1","security_groups":null,"self":true,"to_port":0}]},"vpc_id":{"references":["aws_vpc.example.id","aws_vpc.example"]}},"schema_version":1},{"address":"aws_security_group.allow_ssh","mode":"managed","type":"aws_security_group","name":"allow_ssh","provider_config_key":"vpc:aws","expressions":{"description":{"constant_value":"Allow SSH inbound from anywhere"},"ingress":{"constant_value":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":22,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":22}]},"name":{"constant_value":"allow_ssh"},"vpc_id":{"references":["aws_vpc.example.id","aws_vpc.example"]}},"schema_version":1},{"address":"aws_security_group.allow_ssh_with_valid_cidr","mode":"managed","type":"aws_security_group","name":"allow_ssh_with_valid_cidr","provider_config_key":"vpc:aws","expressions":{"description":{"constant_value":"Allow SSH inbound from specific range"},"ingress":{"references":["var.cidr"]},"name":{"constant_value":"allow_ssh_with_valid_cidr"},"vpc_id":{"references":["aws_vpc.example.id","aws_vpc.example"]}},"schema_version":1},{"address":"aws_vpc.example","mode":"managed","type":"aws_vpc","name":"example","provider_config_key":"vpc:aws","expressions":{"cidr_block":{"references":["var.cidr"]}},"schema_version":1}],"variables":{"cidr":{"default":"255.255.255.0/24"}}}}},"variables":{"region":{"default":"eu-west-1"}}}}}
